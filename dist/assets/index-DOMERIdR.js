import{r as d,j as s,ab as w,ac as f,ad as u,ae as j,e as E,af as v,ag as F,a9 as R,ah as U}from"./index-DDII5y11.js";import{g as V,E as k,D as C,F as I}from"./table-B-N6oWOD.js";import{F as x,u as D,I as h}from"./index-DfFUCOFH.js";import"./useBreakpoint-DZ2z2w6v.js";const M=({visible:e,initialValues:t,onHide:o,onSubmit:r})=>{const[n]=x.useForm(),[a,c]=d.useState(!1),[l,{setTrue:b,setFalse:p}]=D(!1),y=!t,m=()=>{n.resetFields(),o==null||o()},N=g=>{b(),r==null||r(g).then(()=>{p(),m()})};return d.useEffect(()=>{e&&t&&n.setFieldsValue(t)},[e,t]),s.jsxDEV(w,{centered:!0,title:y?"编辑角色":"添加角色",open:e,onCancel:m,onOk:()=>n.submit(),confirmLoading:l,okButtonProps:{disabled:!a},children:s.jsxDEV(x,{form:n,autoComplete:"off",labelCol:{span:4},wrapperCol:{span:20},style:{marginTop:24},onFinish:N,onValuesChange:()=>!a&&c(!0),children:[s.jsxDEV(x.Item,{name:"key",label:"Key",rules:[{required:!0}],children:s.jsxDEV(h,{placeholder:"请输入"},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/components/form-modal.tsx",lineNumber:55,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/components/form-modal.tsx",lineNumber:54,columnNumber:9},void 0),s.jsxDEV(x.Item,{name:"name",label:"名称",rules:[{required:!0}],children:s.jsxDEV(h,{placeholder:"请输入"},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/components/form-modal.tsx",lineNumber:58,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/components/form-modal.tsx",lineNumber:57,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/components/form-modal.tsx",lineNumber:45,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/components/form-modal.tsx",lineNumber:36,columnNumber:5},void 0)},T=async()=>{const{data:e}=await f.get("/role/all");return e},A=async e=>{const{data:t}=await f.post("/role",e);return t},B=async e=>{const{data:t}=await f.put("/role",e);return t},q=async e=>{const{data:t}=await f.delete(`/Role/${e}`);return t},z=()=>{const[e,t]=d.useState(),[o,{setTrue:r,setFalse:n}]=D(!1),{loading:a,data:c,refresh:l}=u(T),{runAsync:b}=u(A,{manual:!0,onSuccess:l}),{runAsync:p}=u(B,{manual:!0,onSuccess:l}),{runAsync:y}=u(q,{manual:!0,onSuccess:l}),m=d.useMemo(()=>e?{key:e==null?void 0:e.key,name:e==null?void 0:e.name}:void 0,[e]),N=j(i=>{r(),t(i)}),g=j(async i=>e?p(i):b(i));return{table:{loading:a,data:c||[]},form:{visible:o,initialValues:m,onHide:n,onSubmit:g},showForm:N,handleDeleteRole:y}},S=()=>{const{table:e,form:t,showForm:o,handleDeleteRole:r}=z(),n=j(c=>{w.confirm({centered:!0,title:"删除角色",content:"你确定要删除此角色吗？",onOk:()=>r(c)})}),a=d.useMemo(()=>[{title:"Key",key:"key",dataIndex:"key",width:200},{title:"名称",dataIndex:"name",width:200},...V(),{title:"操作",key:"action",width:180,render:(c,l)=>s.jsxDEV(E,{children:[s.jsxDEV(k,{onClick:()=>o(l)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:44,columnNumber:15},void 0),s.jsxDEV(C,{onClick:()=>n(l.key)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:45,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:43,columnNumber:13},void 0)}],[o,n]);return s.jsxDEV(v,{size:"large",title:"角色管理",children:[s.jsxDEV(F,{bordered:!1,className:"with-table",title:s.jsxDEV(R,{type:"primary",icon:s.jsxDEV(U,{},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:60,columnNumber:40},void 0),onClick:()=>o(),children:"添加角色"},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:60,columnNumber:11},void 0),children:s.jsxDEV(I,{columns:a,loading:e.loading,dataSource:e.data,scroll:{y:55*8},pagination:!1},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:65,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:56,columnNumber:7},void 0),s.jsxDEV(M,{...t},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:73,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:55,columnNumber:5},void 0)};export{S as default};
