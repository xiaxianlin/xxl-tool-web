import{r as d,j as s,ab as w,ac as f,ad as u,ae as h,e as E,af as R,ag as v,a9 as C,ah as F}from"./index-BozaOah3.js";import{g as U,E as V,D as k,F as I}from"./table-C75AnEwF.js";import{F as x,u as D,I as j}from"./index-BUN2HIeu.js";import{k as M}from"./util-BmWk2NXg.js";import"./useBreakpoint-IGo6ogIv.js";const A=({visible:e,initialValues:t,onHide:o,onSubmit:r})=>{const[n]=x.useForm(),[a,c]=d.useState(!1),[l,{setTrue:b,setFalse:p}]=D(!1),y=!t,m=()=>{n.resetFields(),o==null||o()},N=g=>{b(),r==null||r(g).then(()=>m()).finally(()=>p())};return d.useEffect(()=>{e&&t&&n.setFieldsValue(t)},[e,t]),s.jsxDEV(w,{centered:!0,title:y?"编辑角色":"添加角色",open:e,onCancel:m,onOk:()=>n.submit(),confirmLoading:l,okButtonProps:{disabled:!a},children:s.jsxDEV(x,{form:n,autoComplete:"off",labelCol:{span:4},wrapperCol:{span:20},style:{marginTop:24},onFinish:N,onValuesChange:()=>!a&&c(!0),children:[s.jsxDEV(x.Item,{name:"key",label:"Key",rules:M,children:s.jsxDEV(j,{placeholder:"请输入",maxLength:20,showCount:!0},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/form.tsx",lineNumber:55,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/form.tsx",lineNumber:54,columnNumber:9},void 0),s.jsxDEV(x.Item,{name:"name",label:"名称",rules:[{required:!0}],children:s.jsxDEV(j,{placeholder:"请输入",maxLength:20,showCount:!0},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/form.tsx",lineNumber:58,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/form.tsx",lineNumber:57,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/form.tsx",lineNumber:45,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/form.tsx",lineNumber:36,columnNumber:5},void 0)},B=async()=>{const{data:e}=await f.get("/role");return e},T=async e=>{const{data:t}=await f.post("/role",e);return t},L=async e=>{const{data:t}=await f.put("/role",e);return t},q=async e=>{const{data:t}=await f.delete(`/role/${e}`);return t},P=()=>{const[e,t]=d.useState(),[o,{setTrue:r,setFalse:n}]=D(!1),{loading:a,data:c,refresh:l}=u(B),{runAsync:b}=u(T,{manual:!0,onSuccess:l}),{runAsync:p}=u(L,{manual:!0,onSuccess:l}),{runAsync:y}=u(q,{manual:!0,onSuccess:l}),m=d.useMemo(()=>e?{key:e==null?void 0:e.key,name:e==null?void 0:e.name}:void 0,[e]),N=h(i=>{r(),t(i)}),g=h(async i=>e?p(i):b(i));return{table:{loading:a,data:c||[]},form:{visible:o,initialValues:m,onHide:n,onSubmit:g},showForm:N,handleDeleteRole:y}},$=()=>{const{table:e,form:t,showForm:o,handleDeleteRole:r}=P(),n=h(c=>{w.confirm({centered:!0,title:"删除角色",content:"你确定要删除此角色吗？",onOk:()=>r(c)})}),a=d.useMemo(()=>[{title:"名称",dataIndex:"name",width:200},{title:"Key",dataIndex:"key",width:200},...U(),{title:"操作",key:"action",width:180,render:(c,l)=>s.jsxDEV(E,{children:[s.jsxDEV(V,{onClick:()=>o(l)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:35,columnNumber:15},void 0),s.jsxDEV(k,{onClick:()=>n(l.key)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:36,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:34,columnNumber:13},void 0)}],[o,n]);return s.jsxDEV(R,{size:"large",title:"角色管理",children:[s.jsxDEV(v,{bordered:!1,className:"with-table",title:s.jsxDEV(C,{type:"primary",icon:s.jsxDEV(F,{},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:51,columnNumber:40},void 0),onClick:()=>o(),children:"添加角色"},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:51,columnNumber:11},void 0),children:s.jsxDEV(I,{columns:a,loading:e.loading,dataSource:e.data,scroll:{y:55*8},pagination:!1},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:56,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:47,columnNumber:7},void 0),s.jsxDEV(A,{...t},void 0,!1,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:64,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/bytedance/projects/xxl-tool-web/src/pages/system/role/index.tsx",lineNumber:46,columnNumber:5},void 0)};export{$ as default};
